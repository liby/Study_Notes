# 5.2 Array类型

- JS中数组是数据的有序列表。
  - JS数组的每一项可以保存任何类型的数据。
  - 可以在数组的第一个位置保存字符串，第二个位置保存数值，第三个位置保存对象，以此类推。
  - JS中数组的大小是可以动态调整的。
    - 可以随着数据的添加自动增长以容纳新增数据。
- 创建数组的基本方式有两种。
  1. 第一种是使用Array构造函数。
    `var colors = new Array();`
      - 如果预先知道数组要保存的项目数量，也可以给构造函数传递该数量。
        - 这个数量会变成length属性的值。
          `var colors = new Array(20);`
      - 也可以向Array构造函数传递数组中应该包含的项。
      - 给构造函数传递一个值也可以创建数组。
        - 如果传递的是数值，会按照该数值创建包含给定项数的数组。
        - 如果传递的是其他类型的参数，则会创建包含那个值的只有一项的数组。
      - 使用Array构造函数时，可以省略new操作符。
  2. 创建数组的第二张基本方式是使用数组字面量表示法。
      - 数组字面量由一对包含数组项的方括号表示，多个数组项之间以逗号隔开。
        ```js
        var colors = ["red", "blue", "green"];
        var names = [];
        var values = [1,2,];  //不要这样，这样会创建一个包含2或3项的数组
        var options = [,,,,,]  // 不要这样，这样会创建一个包含5或6项的数组
        ```
> 与对象一样，在使用数组字面量表示法时，也不会调用Array构造函数。

- 在读取和设置数组的值时，要使用方括号并提供相应值的基于0的数字索引。
  - 方括号中的索引表示要访问的值。
    - 如果索引小于数组中的项数，则返回对应项的值。
    - 设置数组的值也使用相同的语法。
    - 如果设置某个值的索引超过了数组现有项数，数组就会自动增加到该索引值加1的长度。
- 数组的项数保存在其length属性中，这个属性始终会返回0或更大的值。

- 数组的length属性不是只读的，通过设置这个属性，可以从数组的末尾移除项或向数组中添加新项。
  - 如果将其设置为大于数组项数的值，则新增的每一项都会取得undefined的值。
- 利用length属性也可以方便地在数组末尾添加新项。

  ```js
  var colors = ["red", "blue", "green"];
  colors[colors.length] = "black";  //在位置3添加一种颜色
  colors[colors.length] = "brown";  //在位置4添加一种颜色

- 由于数组最后一项的索引始终是length-1，因此下一个新项的位置就是length。

- 当把一个值放在超出当前数组大小的位置上时，数组就会重新计算其长度值。
  - 长度值等于最后一项的索引加1。

> 数组最多可以包含4294967295个项，如果超过这个上限值，就会发生异常。创建一个初始大小与合格上限值接近的数组，可能会导致运行时间超长的脚本错误。

## 5.2.1 检测数组

- instanceof操作符的问题在于，它假定只有一个全局执行环境。
  - 如果网页中包含多个框架，那实际上就存在两个以上不同的全局执行环境，也就存在两个以上不同版本的Array构造函数。
    - 如果你从一个框架向另一个框架传入一个数组，那么传入的数组与在第二个框架中原生创建的数组分别具有各自不同的构造函数。
- ES5新增的Array.isArray()函数解决了这个问题。
  - 这个方法的目的是最终确定某个值到底是不是数组。不管它是在哪个全局执行环境中创建的。
    ```js
    if (Array.isArray(value)) {
      //对数组执行某些操作
    }
    ```

## 5.2.2 转换方法

- 所有对象都具有toLocaleString()、toString()和valueOf()方法。
  - 调用数组的toString()方法会返回由数组中每个值的字符串形式拼接而成的一个以逗号的字符串，而调用valueOf()返回的还是数组。
  - 调用数组的toLocaleString()方法时，它会创建一个数组值的以逗号分隔的字符串。
    - 与前两种方法唯一的不同在于，为了取得每一项的值调用的是每一项的toLocaleString()方法。
- 数组继承的toLocaleString()、toString()和valueOf()方法，在默认情况下都会以逗号分隔的字符串形式返回数组项。
  - 如果使用join()方法，可以使用不同的分隔符来构建这个字符串。
    - join()方法只接收一个参数，即用作分隔符的字符串。
> 如果数组中的某一项的值是null或者undefined，那么该值在join()、toLocaleString()、toString()和valueOf()方法返回的结果中以空字符串表示。

## 5.2.3 栈方法

- JS数组提供了一种让数组的行为类似于其他数据结构的方法。
  - 数组可以表现得像栈一样，栈是一种可以限制插入和删除项的数据结构，栈是一种LIFO（后进先出）的数据结构。
    - 栈中项的插入（推入）和移除（弹出），都发生在**栈的顶部**。
  - JS为数组专门提供了push()和pop()方法。
- push()方法可以接收任意数量的参数，它们逐个添加到数组末尾，并返回修改后数组的长度。

- pop()方法将从数组末尾移除最后一项，减少数组的length值，然后返回移除的项。

## 5.2.4 队列方法

- 队列数据结构的访问规则是FIFO（先进先出）。
  - 队列在列表的末端添加项，从列表的前端移除项。
  - shift()方法能够移除数组中第一个项并返回该项，同时将数组长度减1。
  - 结合使用shift()和push方法，可以像队列一样使用数组。

- JS还为数组提供了一个unshift()方法。
  - 这个方法可以在数组前端添加任意个项并返回新数组的长度。
  - 同时使用unshift()和pop()方法，可以从相反的方向来模拟队列。

## 5.2.5 重排序方法

- 数组中已经存在两个可以直接用来重排序的方法:reverse()和sort()。
    ```js
    var values = [1, 2, 3, 4, 5];
    values.reverse();
    console.log(values);  //5,4,3,2,1
    ```
  - reverse()会反转数组项的顺序，相当直观明了，但不够灵活。

- sort()方法按升序排列数组项——即最小的值位于最前面，最大的值排在最后面。
  - 为了实现排序，sort()方法会调用每个数组项的toString()转型方法，然后比较得到的字符串，以确定如何排序。
  - 即使数组中每一项都是数值，sort()方法比较的也是字符串。
  - sort()方法可以接收一个比较函数作为参数，以便我们指定哪个值位于哪个值的前面。
    - 比较函数接收两个参数，如果第一个参数应该位于第二个之前则返回一个负数，如果两个参数相等则返回0，如果第一个参数应该位于第二个之后则返回一个正数。
      ```js
      function compare(value1, value2) {
        if (value1 < value2) {
          return -1;
        } else if (value1 > value2) {
          return 1;
        } else {
          return 0;
        }
      }
      ```
    - 这个比较函数可以适用于大多数数据类型，只要将其作为参数传递给sort()方法即可。
      - 也可以通过比较函数产生降序排序的结果，只要交换比较函数返回的值即可。
    - 