# 3.4 数据类型

- JS中有5种简单数据类型（即基本数据类型）:
  1. Undefined
  2. Null
  3. Boolean
  4. Number
  5. String
- 还有1种复杂数据类型—— Object。
- Object 本质上是由一组无序的名值对组成的。
- JS不支持任何创建自定义类型的机制。

  **所有值最终都将是上述6种数据类型之一。**

- JS数据类型具有动态性，因此没有再定义其他数据类型的必要了。

## 3.4.1 typeof操作符

- typeof可以检测给定变量的数据类型。
- 对一个值使用typeof操作符可能返回下列某个字符串:
  - "undefined"——如果这个值未定义；
  - "boolean"——如果这个值是布尔值；
  - "string"——如果这个值是字符串；
  - "number"——如果这个值是数值；
  - "object"——如果这个值是对象或 null；
  - "function"——如果这个值是函数。
- typeof操作符的操作数可以是变量，也可以是数值字面量。

  **typeof是一个操作符而不是函数，操作数可以用圆括号括起来，也可以不用。**

- typeof操作符有时会返回一些令人迷惑但技术上却正确的值。
  - 调用 `typeof null`会返回"object",因为特殊值null被认为是一个空的对象引用。

  > 函数从技术角度讲在JS中是对象，不视一种数据类型。
  > 函数也有一些特殊的属性，因此通过typeof操作符来区分函数和其他对象是有必要的。

## 3.4.2 Undefined类型  

- Undefined类型只有一个值，在使用var声明变量但未对其加以初始化时，这个变量的值就是undefined。

  **一般不存在需要显式地把一个变量设置位undefined值的情况。**

  **引入undefined值是为了正式区分空对象指针与未经初始化的变量。**

  **包含undefined值的变量与尚未定义的变量是不一样的。**

- 对于尚未声明过的变量，只能执行typeof操作符检测其数据类型。
  - 对未经声明的变量调用delete没什么实际意义，在严格模式下会导致错误。
- 对未初始化和未声明的变量执行typeof操作符都返回undefined值。

  **显示地初始化变量时，当typeof操作符返回"undefined"值时，就知道检测的变量没被声明，而不是尚未初始化。**

## 3.4.3 Null类型

- Null类型是第二个只有一个值的数据类型。
- 从逻辑角度来看，null值表示一个空对象指针，这也是使用typeof操作符检测null值时返回"object"的原因。
- 如果定义的变量准备在将来用于保存对象，那么最好将该变量初始化为null而不是其他值。
  - 这样只要直接检测null值就可以知道相应的变量是否已经保存了一个对象的引用。

- undefined值派生自null值。
  > `null == undefined; //true`

## 3.4.4 Boolan类型

- 这个类型只有两个字面值:true和false。
- Boolean类型的字面值是区分大小写的。
  - 其他混合大小写的形式都不是Boolean值，只是标识符。
- JS中所有类型的值都有与这两个Boolean值等价的值。
  - 要将一个值转换为其对应的Boolean值，可以调用转型函数Boolean()。
  - 下表给出了各种数据类型及其对应的转换规则:

    | 数据类型 | 转换为true的值 | 转换为false的值 |
    | :------: | :------: | :------: |
    | Boolean | true | false |
    | String | 任何非空字符串 | 空字符串 |
    | Number | 任何非零数字(包括无穷大) | 0和NaN |
    | Object | 任何对象 | null |
    | Undefined | 不适用 | undefined |

  > 错误地使用一个对象而不是一个Boolean值，有可能会彻底改变应用程序的流程。

## 3.4.5 Number类型

- Number类型应该是JS中最令人关注的数据类型。
  - 这种类型使用IEEE754格式来表示整数和浮点数值。
- 最基本的数值字面量格式是十进制整数，十进制数字可以直接在代码中输入。
  - 除十进制以外，整数还可以通过八进制或十六进制的字面值来表示。
    - 八进制的字面值第一位必须是 0 ，然后是八进制数字序列（0-7）。
    - 如果字面值中的数值超出了范围，那么前导零将被忽略，后面的数值会被当做十进制数值解析。
    - 八进制字面量在严格模式下是无效的。
  - 十六进制字面值的前两位必须是0x，后跟任何十六进制数字（0-9及A-F）。字母可以大写，也可以小写。
  - 在进行运算时，所有以八进制和十六进制表示的数值最终都将被转换成十进制数值。
  > JS中可以保存 +0 和 -0 ,它们被认为相等。

### 1.浮点数值

- 浮点数值中必须包含一个小数点，并且小数点后面必须至少有一位数字。
  - 小数点前面可以没有整数，但是不推荐这种写法。
- 保存浮点数值需要的内存空间是保存整数值的两倍，因此JS会不失时机地将浮点数值转换为整数值。
  - 如果小数点后面没有跟任何数字，这个数值就可以作为整数值来保存。
  - 如果浮点数值本身表示的就是一个整数（如1.0），那么该值也会被转换为整数。
  - 对于极大或极小的数值，可以用e表示法（科学计数法）表示的浮点数值表示。
    - e表示法表示的数值等于e前面的数值乘以10的指数次幂。
      `var floatNum = 3.125e7; // 等于 31250000`
    - 在默认情况下，JS会将那些小数点后面带有6个0以上的浮点数值转换为以e表示法表示的数值。
- 浮点数值的最高精度是17位小数，但在进行算术计算时其精确度远远不如整数。

> 永远不要测试某个特定的浮点数值。

- 使用浮点数值计算会产生舍入误差的问题，这是使用基于IEEE754数值的浮点计算的通病。

### 2.数值范围

- 由于内存限制，JS能够表示最小的数值保存在Number.MIN_VALUE中，在大多数浏览器中，这个值是5e-324.

- 能够表示最大的数值保存在Number.MAX_VALUE中，在大多数浏览器中，这个值是1.7976931348623157e+308。

- 如果计算时超过了这个数值范围，那么这个数值会被自动转换成特殊的Indinity值。
  - 这个数值是负数，则会被转换成-Infinity。
  - 如果是正数，则会被转换成Infinity。

- 如果某次计算返回了正或负的Infinity值，那么这个值无法继续参与计算。
  - 要想确定一个数值是不是有穷的，可以使用isFite()函数。
  - 这个函数在参数位于最小与最大数值之间会返回true。
> 执行极大或极小数值的计算时，检测监控这些值是可能的，也是必须的。

- 访问Number.NEGATIVE_INFINITY和Number.POSITIVE_INFINITY也可以得到负和正Infinity的值。可以想见，这两个属性中分别保存着-Infinity和Infinity。

### 3.NaN

- 即非数值，是一个特殊的数值。用于表示一个本来要返回数值的操作数未返回数值的情况。

- 在JS中，任何数值除以0都会返回NaN，不会影响其他代码的执行。
  > 实际上只有 0 除以 0 才会返回 NaN，正数除以 0 返回 Infinity，负数除以 0 返回-Infinity.

- NaN本身有两个非同寻常的特点:
  1. 任何设计NaN的操作都会返回NaN；这个特点在多部计算中有可能导致问题；
  2. NaN与任何值都不相等，包括NaN本身。

- 针对NaN的这两个特点，JS定义了isNaN()函数，这个函数接收一个参数，可以是任何类型，这个函数会检测这个参数是否 "不是数值"。
  - isNaN()在接收到一个值后，会尝试将这个值转换为数值。
  - 某些不是数值的值会直接转换为数值。
  - 任何不能被转换为数值的值都会导致这个函数返回true。

- isNaN()函数适用于对象，在基于对象调用这个函数时，会首先调用对象的valueOf()方法，然后确定该方法返回的值是否可以转换为数值。
  - 如果不能，则基于这个返回值再调用toString()方法，再测试返回值。
  - 这个过程也是JS中内置函数和操作符的一般执行流程。

### 4.数值转换

- 有3个函数可以把非数值转换为数值: Number()、parseInt() 和 parseFloat()。
  - Number()适用于任何数据类型。
  - 另外两个函数专门用于把字符串转换成数值。

- Number()函数的转换规则如下:
  1. 如果是Boolean值，true和false将分别被转换为1和0。
  2. 如果是数字值，只是简单的传入和返回。
  3. 如果是null值，返回0。
  4. 如果是undefined，返回NaN。
  5. 如果是字符串，遵循下列规则:
      - 如果字符串中只包含数字（包括前面带正号或负号的情况），则将其转换为十进制数值。即"1"会变成 1，"123"会变成 123，而"011"会变成 11（注意：前导的零被忽略了）；
      - 如果字符串中包含有效的浮点格式，如"1.1",则将其转换为对应的浮点数值（同样，也会忽略前导零）；
      - 如果字符串中包含有效的十六进制格式，例如"0xf",则将其转换为相同大小的十进制整数值；
      - 如果字符串是空的（不包含除空格以外的其他任何字符),则将其转换为0；
      - 如果字符串中包含除上述格式之外的字符，则将其转换为NaN。
  6. 如果是对象，则调用对象的 valueOf()方法，然后依照前面的规则转换返回的值。
      - 如果转换的结果是NaN，则调用对的toString()方法，然后再次依照前面的规则转换返回的字符串值。
  > 一元加操作符的操作于Number()函数相同。

- 由于Number()函数在转换字符串时比较复杂而且不够合理，因此在处理整数时更常用parseInt()函数。
  - parsrInt()函数在转换字符串时，更多的是看其是否符合数值模式。
  - 它会忽略字符串前面的空格，直到找到第一个非空格字符。
  - 如果第一个字符不是数字字符或者负号，parseInt()就会返回NaN。
  - 用parseInt()转换空字符串会返回NaN。
  - 如果第一个字符是数字字符，parseInt()会继续解析第二个字符，直到解析完所有后续字符或者遇到了一个非数字字符。
- 如果字符串中的第一个字符是数字字符，parseInt()也能识别出各种整数格式。

> ES5中，parseInt()已经不具备解析八进制值的能力，因此前导的零会被认为无效。

- 这个函数还可以接收第二个参数（转换时使用的基数）。

- 不指定基数意味着让parseInt()决定如何解析输入的字符串。
  - 为了避免错误的解析，最好在任何情况下都明确指定基数。

> 多数情况下我们要解析的都是十进制数值，因此始终将10作为第二个参数是非常必要的。

- parseFloat()与parseInt()函数类似，也是从第一个字符（位置0）开始解析每个字符，一直解析到字符串末尾。或者解析遇到一个无效的浮点数字字符为止。
  - 即字符串中第一个小数点是有效的，第二个小数点就是无效的,它后面的字符串会被忽略。
  
- parseFloat()始终都会忽略前导的零。
  - 可以识别前面讨论过的浮点数值格式。
  - 但十六进制格式的字符串始终会被转换成0.
  - 没有第二个参数指定基数的用法。
> 如果字符串包含的是一个可解析为整数的数（没有小数点，或小数点后都是零），parseFloat()会返回整数。

## 3.4.5 String类型

- String类型用于表示由零或多个16位Unicode字符组成的字符序列，即字符串。
  - 字符串可以由双引号或单引号表示。
  - 左右引号必须匹配

### 1.字符字面量

- Sring数据类型包含一些特殊的字符字面量，也叫转义序列。
  - 用于表示非打印字符，或者有具有其他用途的字符。

| 字面量 | 含义 |
| :---: | :-: |
| \n | 换行 |
| \t | 指标 |
| \b | 空格 |
| \r | 回车 |
| \f | 换页 |
| \\ | 斜杠 |
| \' | 单引号 |
| \" | 双引号 |
| \Xnn | 以十六进制代码表示一个字符 |
| \Unnn | 以十六进制代码表示一个Unicode字符 |

- 这些字符字面量可以出现在字符串中的任意位置，也将被作为一个字符来解析。
  - 任何字符串的长度都可以通过其length属性取得。
  - 如果字符串中包含双字节字符，那么length属性可能不会精确地返回字符串中的字符数目。

### 2.字符串的特点

- JS中的字符串是不可变的，即字符串一旦创建，它的值就不能改变。
- 要改变某个变量保存的字符串。 1. 首先要销毁原来的字符串； 2. 然后再用另一个包含新值的字符串填充该变量。 ### 3.转换为字符串

- 要把一个值转换为一个字符串有两种方式:
  1. 使用几乎每个值都有的toString()方法。
      - 数值、布尔值、对象和字符串值都有toString()方法;
      > 字符串值的toString()方法返回字符串的一个副本。
      - 但null和undefined值没有这个方法。
      - 一般情况下，调用toString()方法不必传递参数。
        - 但是在调用数值的toString()方法时，可以传递一个参数:输出数值的基数；
        - 默认是以十进制格式返回数值的字符串表示。
        - 通过传递基数，可以输出以二进制、八进制、十六进制乃至其他任意有效进制表示的字符串值。
      - 通过指定基数，toString()方法会改变输出的值。
        - 默认的没有参数的输出值与指定基数 10 时的输出值相同。
  2. 在不知道要转换的值是不是null或undefined的情况下，还可以使用转型函数String()。
      - 这个函数能将任何类型的值转换为字符串。
      - String()函数遵循下列转换规则:
        1. 如果值有toString()方法，则调用该方法（不传参数）并返回相应结果；
        2. 如果值是null，则返回"null"；
        3. 如果值是undefined，则返回"undefined"。
- 要把某个值转换为字符串，可以使用加号操作符把它与一个字符串加在一起。

## 3.4.7 Object类型

- JS中的对象其实就是一组数据和功能的集合，对象可以通过执行new操作符后跟创建对象类型的名称来创建。
  - 创建Object类型的实例并为其添加属性和方法，就可以创建自定义对象。
  - 在JS中如果不给构造函数传递参数，则可以忽略后面的那一对圆括号。
  `var o = new Object;  //有效，但不推荐省略圆括号`
- 在JS中，Object类型是所有它的实例的基础。
  - Object类型所具有的任何属性和方法也同样存在于更具体的对象中。
- Object的每个实例都具有下列属性和方法:
  - constructor: 保存着用于创建当前对象的函数。
    - 构造函数就是Object()。
  - hasOwnProperty(propertyName): 用于检查给定的属性在当前对象实例中（而不是实例的原型中）是否存在。
    - 作为参数的属性名（propertyName)必须以字符串形式指定。
  - isPrototypeOf(object): 用于检查传入的对象是否是传入对象的原型。
  - propertyIsEnumerable(propertyName): 用于检查给定的属性是否能够使用for-in语句来枚举。
    - 作为参数的属性名必须以字符串形式指定。
  - toLoclaeString(): 返回对象的字符串表示，该字符串与执行环境的地区对应。
  - toString(): 返回对象的字符串表示。
  - valueOf(): 返回对象的字符串、数字或布尔值表示。
    - 通常与toString()方法的返回值相同。
  > 因为在JS中Object是所有对象的基础，因此所有对象都具有这些基本的属性和方法。
- BOM和DOM中的对象，都属于宿主对象，因此可能不会继承Object。